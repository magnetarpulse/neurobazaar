{% extends 'base.html' %}

{% block title %}Datastore{% endblock title %}
{% block nav4 %} d-none {% endblock nav4 %}
{% block body %}

<!-- Masthead-->
<header class="masthead" style="background">
    <div class="container">
        <div class="masthead-heading">Set up your datastore</div>
    </div> 
</header>

<!-- Configuration Section -->
<section class="page-section bg-light">
    <div class="container">
        <div class="text-center">
            <h2 class="section-heading text-uppercase">DataStore Configuration</h2>
        </div>
        <form id="databaseForm" method="post">
            {% csrf_token %}
            <div class="mb-3">
                <label for="database">Add Datastore :</label>
                <select class="form-control" id="database" name="database" onchange="showForm()">
                    <option value="default">Select a Database</option>
                    <option value="filesystem">FileSystem</option>
                    <option value="mongodb">MongoDB</option>
                </select>
            </div>

            <!-- FileSystem Configuration -->
            <div id="filesystemForm" class="hidden">
                <h4>FileSystem Configuration</h4>
                <div class="mb-3">
                    <label for="destination_path">Destination Path:</label>
                    <input type="text" class="form-control" id="destination_path" name="destination_path">
                </div>
                <button type="submit" class="btn btn-primary" name="add_datastore">Add FileSystem</button>
            </div>

            <!-- MongoDB Configuration -->
            <div id="mongodbForm" class="hidden">
                <h4>MongoDB Configuration</h4>
                <div class="mb-3">
                    <label for="client_mongo">Client:</label>
                    <input type="text" class="form-control" id="client_mongo" name="client_mongo">
                </div>
                <div class="mb-3">
                    <label for="db_mongo">DB:</label>
                    <input type="text" class="form-control" id="db_mongo" name="db_mongo">
                </div>
                <div class="mb-3">
                    <label for="table_mongo">Table:</label>
                    <input type="text" class="form-control" id="table_mongo" name="table_mongo">
                </div>
                <button type="submit" class="btn btn-primary" name="add_datastore">Add MongoDB</button>
            </div>
        </form>

        <!-- Existing DataStores -->
        <h3 class="mt-5">Existing DataStores</h3>
        <div class="list-group">
            {% for datastore in datastores %}
            <div class="list-group-item">
                {{ datastore.DataStore_Name }} - {{ datastore.Destination_Path }}
                <!-- Add a form for removing a DataStore -->
                <form method="post" action="" style="display: inline;">
                    {% csrf_token %}
                    <input type="hidden" name="datastore_id" value="{{ datastore.DataStore_ID }}">
                    <button type="submit" class="btn btn-danger" name="remove_datastore">Remove</button>
                </form>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Footer-->
<footer class="footer py-4">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-4 text-lg-start">Copyright &copy; Neurobazaar 2024</div>
            <div class="col-lg-4 my-3 my-lg-0">
                <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
            </div>
            <div class="col-lg-4 text-lg-end">
                <a class="link-dark text-decoration-none me-3" href="#!">Privacy Policy</a>
                <a class="link-dark text-decoration-none" href="#!">Terms of Use</a>
            </div>
        </div>
    </div>
</footer>

<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f9;
        color: #333;
        margin: 0;
    }

    h2 {
        color: #0056b3;
    }

    .form-control {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    button {
        background-color: #0056b3;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
    }

    button:hover {
        background-color: #004494;
    }

    .hidden {
        display: none;
    }
</style>

<script>
    function showForm() {
        var database = document.getElementById('database').value;
        document.getElementById('filesystemForm').classList.add('hidden');
        document.getElementById('mongodbForm').classList.add('hidden');
        
        if (database === 'filesystem') {
            document.getElementById('filesystemForm').classList.remove('hidden');
        } else if (database === 'mongodb') {
            document.getElementById('mongodbForm').classList.remove('hidden');
        }
    }
</script>

{% endblock body %}
